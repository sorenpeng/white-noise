# 核心音频逻辑

本文档描述了白噪音应用最核心的音频生成与调制引擎。该引擎独立于任何用户界面和交互，专注于根据一组抽象参数动态生成和塑造声景。

## 1. 音频信号链

引擎的音频信号处理流程（Signal Chain）遵循以下结构：

```
[声源] -> [效果器] -> [主输出]
```

具体到 `Tone.js` 的实现，其结构为：

1.  **声源 (Sources)**
    *   一个正弦波振荡器 (`Tone.Oscillator`)
    *   一个粉红噪声合成器 (`Tone.Noise`)
2.  **效果器 (Effects)**
    *   噪声源连接到一个低通滤波器 (`Tone.Filter`)。
    *   振荡器和经过滤波的噪声混合后，一同送入一个混响效果器 (`Tone.Reverb`)。
3.  **主输出 (Master Output)**
    *   混响的输出连接到一个主增益节点 (`Tone.Gain`)，用于控制总音量。
    *   主增益节点最终连接到音频目标设备（即扬声器）。

全局的节拍和速度由 `Tone.Transport` 模块统一管理。

## 2. 参数化控制模型

引擎由三个核心的抽象参数驱动，每个参数都映射到一个或多个具体的音频属性。这些参数及其映射关系如下：

### a. 能量 (Energy)

此参数控制声音的“充沛”程度和空间感。

*   **映射目标**:
    *   `master.gain`: 主增益节点的音量。`Energy` 越高，音量越大。
    *   `reverb.wet`: 混响效果的干湿比。`Energy` 越高，混响感越强，空间越开阔。

### b. 明暗 (Brightness)

此参数控制声音的“音色”，即温暖、模糊与清晰、明亮之间的过渡。

*   **映射目标**:
    *   `filter.frequency`: 应用于噪声源的低通滤波器的截止频率。`Brightness` 越高，截止频率越高，允许更多高频成分通过，声音更明亮。
    *   `reverb.preDelay`: 混响的预延迟时间。`Brightness` 越高，预延迟越长，能产生更清晰的早期反射感。

### c. 速度 (Speed)

此参数控制声景的内在“脉动”或“呼吸”速率。

*   **映射目标**:
    *   `Tone.Transport.bpm`: 全局传输模块的每分钟节拍数 (BPM)。`Speed` 越高，BPM 越快，由 `Transport` 调度的事件（如节拍脉冲）频率也越高。